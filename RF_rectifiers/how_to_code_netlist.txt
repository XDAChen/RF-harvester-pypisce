# SPICE Netlist Reference

Guide for writing build_netlist() functions that generate SPICE netlists.

## Netlist Structure

```
Circuit Title
* Comment line
Component definitions...
.control
  simulation commands
.endc
.end
```

## Component Syntax

| Component | Syntax | Example |
|-----------|--------|---------|
| Resistor | Rname n1 n2 value | Rload vout 0 5k |
| Capacitor | Cname n1 n2 value | Cout vout 0 100p |
| Diode | Dname anode cathode MODEL | D1 in vout SMS7630 |
| Voltage | Vname n+ n- TYPE(params) | Vrf in 0 SIN(0 0.3 2.45e9) |
| Include | .include path | .include diode_models.lib |

Node 0 is ground. Other names are arbitrary.

## Sinusoidal Source

```
Vrf rf_source 0 SIN(offset amplitude frequency)
    |                  |      |         |
    |                  |      |         +-- Hz
    |                  |      +------------ V peak
    |                  +------------------- V DC
    +-------------------------------------- name
```

## Transient Simulation

```
.control
set filetype=ascii
tran 10p 50n uic
wrdata output.txt time v(rf_in) v(vout)
quit
.endc
```

tran syntax: `tran step stop [start] [uic]`

## Example Function

```python
def build_netlist(freq=2.45e9, amplitude=0.3):
    netlist = f"""Half-wave Rectifier
.include diode_models.lib

Vrf rf_in 0 SIN(0 {amplitude} {freq})
Rs rf_in input 50
Cin input diode_in 100p
D1 diode_in vout SMS7630
Cout vout 0 100p
Rload vout 0 5k

.control
set filetype=ascii
tran 10p 50n uic
wrdata sim_data.txt time v(rf_in) v(vout)
quit
.endc
.end
"""
    return netlist
```

## Using Build Functions

```python
from halfwave_rectifier import build_netlist
from utility import run_halfwave_simulation

netlist, t_stop, n_cyc, t_step = build_netlist()
data = run_halfwave_simulation(netlist, t_stop, n_cyc, t_step)
```

## Tips

- Node names are case-insensitive
- Use f-strings for parameter insertion
- wrdata signals must match what run_*_simulation() parses
- Comments with * help document circuit sections
